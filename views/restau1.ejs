<!DOCTYPE html>
<html>
<head>
  <link rel="icon" type="png" href="favicon.png">
  <link rel="stylesheet" href="restauReviews.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reviews</title>
</head>
</style>
<body>

    <nav>
        <div class="title">FlavorFinds</div>
        <!--TODO: profile dropdown-->
        <a href="/profile">Profile</a>
        <a href="/restau1">Reviews</a>
        <a href="/home.html">Home</a>
        <a href="/aboutus">About us</a>
        <div class="search-container">
        <input type="text" id="search" placeholder="Search">
        <button type="button"><i class="fas fa-search"></i></button>
        </div>
    </nav>

    <!-- restau1.ejs -->

    
    <% var selectedCategoryId; %>    
    <div class="categoriesContainer">
        <div class="Categories">
            <% categories.forEach((category, index) => { %>
                <% if (!selectedCategoryId && category.name === 'DIN TAI FUNG' && req.originalUrl === '/restau1') { %>
                    <% selectedCategoryId = category._id; %>
                    <a href="/restau1"><%= category.name %></a>
                <% } else if (!selectedCategoryId && category.name === 'The Aristocrat' && req.originalUrl === '/restau2') { %>
                    <% selectedCategoryId = category._id; %>
                    <a href="/restau2"><%= category.name %></a>
                <% } else if (!selectedCategoryId && category.name === "Italliani's" && req.originalUrl === '/restau3') { %>
                    <% selectedCategoryId = category._id; %>
                    <a href="/restau3"><%= category.name %></a>
                <% } else if (!selectedCategoryId && category.name === 'Lugang Cafe' && req.originalUrl === '/restau4') { %>
                    <% selectedCategoryId = category._id; %>
                    <a href="/restau4"><%= category.name %></a>
                <% }else if (!selectedCategoryId && category.name === 'Bistro Ravioli' && req.originalUrl === '/restau5') { %>
                    <% selectedCategoryId = category._id; %>
                    <a href="/restau5"><%= category.name %></a>
                <% } else { %>
                    <a href="<%= `restau${index + 1}` %>"><%= category.name %></a>
                <% } %>
            <% }); %>
        </div>
    </div>
    



    
    <div class="outerContainer">
        <div class="restaurantInfo">
            <div class="restaurantPic">
                <img src="restauPics/dintaifung.webp">
            </div>
            
            <div class="restaurantDescription">
                <h1>Din Tai Fung</h1>
                <p>Din Tai Fung is known for its signature dish, xiao long bao, a type of steamed dumpling filled with soup and meat, the dumplings are carefully crafted by skilled chefs and are made fresh to order, ensuring quality and flavour. For anyone looking to experience traditional Taiwanese cuisine and sample some of the best dumplings in the world, eating at Din Tai Fung is absolutely essential for you foodies out there!
                </p>
            </div>
        </div>
  
        <div class="mainContainer">
            <div class="reviewsContainer">
                <div class="card-column">
                    <% reviews.forEach(review => { %>
                        <div class="card">
                            <div class="info">
                                <% if (review.avatar && review.avatar.trim() !== '') { %>
                                  <img src="<%= review.avatar.replace(/\\/g, '/') %>" alt="Review Avatar">
                                <% } else { %>
                                  <img src="avatar.jpg" alt="Default">
                                <% } %>
                                <p>@<%= review.username %></p>
                              </div>
                                                                              
                            <div class="description">
                                <div class="rating">
                                    <p>Rating: <%= review.recommended ? 'recommended' : 'not recommended' %></p>
                                </div>
                                <div class="title">
                                    <p><%= review.title %></p>
                                </div>
                                <div class="body">
                                    <p><%= review.body %></p>
                                </div>
                                <div class="establishmentProfile">
                                    <% if (review && review.image && review.image.trim() !== '') { %>
                                        <img src="<%= review.image.replace(/\\/g, '/') %>">
                                    <% } %>
                                </div>
                            </div>
                            <div class="hepfulUnhelpfulContainer">
                                <div class="hepfulUnhelpful">
                                    <span class="helpfulUnhelpfulButton helpfulButton">Helpful</span>
                                    <span class="helpfulUnhelpfulCount"><%= review.helpful %></span>
                                </div>
                                <div class="hepfulUnhelpful">
                                    <span class="helpfulUnhelpfulButton unhelpfulButton">Unhelpful</span>
                                    <span class="helpfulUnhelpfulCount"><%= review.unhelpful %></span>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>

            <!-- TRY KO TO-->
        <div class="submitReviewsContainer">
                <form action="/submitReview" method="post" enctype="multipart/form-data">
                  <div id="review">Submit a Review</div>
                  <% if (user && user.username) { %>
                    <!-- If user is logged in and 'username' property exists -->
                    <input type="hidden" name="username" value="<%= user.username %>">
                  <% } %>
                  <textarea name="title" id="titleTextArea" cols="30" rows="10" placeholder="Title..."></textarea>
                  <textarea name="body" id="bodyTextArea" cols="30" rows="10" placeholder="Body..."></textarea>
                  <div id="recommendation">
                    <input type="radio" id="recommend" name="recommendation" value="recommend"> Recommend
                    <input type="radio" id="notRecommend" name="recommendation" value="notRecommend"> Not Recommended
                  </div>
                  <div id="fileUpload">
                    <label for="file">Upload Image/Video:</label>
                    <input type="file" id="file" name="image" accept="image/*, video/*">
                  </div>
                  <input type="hidden" name="categoryID" value="<%= selectedCategoryId %>">
                  <div id="send">
                    <button class="button" type="submit">Post</button>
                  </div>
                </form>
        </div>

    </div>
   </div>     




 
</body>
</html>